plugins {
    id 'com.android.library'
    id 'org.jetbrains.kotlin.android'
    id 'org.jetbrains.kotlin.plugin.serialization'
    id 'maven-publish'
}

android {
    namespace 'com.ustadmobile.httpoverbluetooth'
    compileSdk 35

    defaultConfig {
        minSdk 26
        targetSdk 35

        testInstrumentationRunner "androidx.test.runner.AndroidJUnitRunner"
        consumerProguardFiles "consumer-rules.pro"
    }

    buildTypes {
        release {
            minifyEnabled false
            proguardFiles getDefaultProguardFile('proguard-android-optimize.txt'), 'proguard-rules.pro'
        }
    }

    compileOptions {
        coreLibraryDesugaringEnabled true

        sourceCompatibility JavaVersion.VERSION_17
        targetCompatibility JavaVersion.VERSION_17
    }

    kotlinOptions {
        jvmTarget = JavaVersion.VERSION_17
    }
}

dependencies {
    implementation libs.androidx.core.ktx
    implementation libs.androidx.appcompat
    implementation libs.rawhttp.core
    implementation libs.kotlinx.serialization.json
    implementation libs.datastore.preferences

    implementation libs.bcprov.jdk18on
    implementation libs.bcpkix.jdk18on

    implementation libs.ipaddress
    implementation libs.androidx.room.runtime.android

    coreLibraryDesugaring libs.android.desugar.jdk.libs

    testImplementation libs.junit.jupiter
    testImplementation libs.mockito.kotlin
    testImplementation libs.turbine
    testImplementation libs.mockwebserver
    testImplementation libs.okhttp

    androidTestImplementation libs.androidx.junit
    androidTestImplementation libs.androidx.test.rules
    androidTestImplementation libs.androidx.test.ext.junit
    androidTestImplementation libs.turbine
    androidTestImplementation libs.mockito.android
    androidTestImplementation libs.mockito.kotlin
}

publishing {
    publications {
        release(MavenPublication) {
            groupId = rootProject.group
            artifactId = project.name
            version = rootProject.version

            afterEvaluate {
                from components.release
            }
        }
    }
}
